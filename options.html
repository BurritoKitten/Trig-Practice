<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trig Options</title>
  <link rel="icon" type="image/x-icon" href="./favicon.ico">
  <link rel="stylesheet" href="./style.css">
  </style>
</head>

<script type="text/javascript" src="./functions.js"></script>

<body>
  <div class="last container">
    <h1>Options</h1>
    <box>
      <label class="toggle-container">
        <input type="checkbox" class="toggle-input" id="full_circle_toggle">
        <span class="toggle-slider"></span>
      </label>
      <label class="toggle-label">Full circle</text>
    </box>
    <box>
      <label class="toggle-container">
        <input type="checkbox" class="toggle-input" id="degree_toggle" checked>
        <span class="toggle-slider"></span>
      </label>
      <label class="toggle-label">Degrees</label>
    </box>
    <box>
      <label class="toggle-container">
        <input type="checkbox" class="toggle-input" id="radian_toggle">
        <span class="toggle-slider"></span>
      </label>
      <label class="toggle-label">Radians</label>
    </box>
    <box>
      <label class="toggle-container">
        <input type="checkbox" class="toggle-input" id="circle_toggle">
        <span class="toggle-slider"></span>
      </label>
      <label class="toggle-label">Hide circle (type only)</label>
    </box>
    <box>
      <label class="toggle-container">
        <input type="checkbox" class="toggle-input" id="coordinate_toggle">
        <span class="toggle-slider"></span>
      </label>
      <label class="toggle-label">Hide coordinates</label>
    </box>
    <!--
    <br>
    Change name:
    <form onsubmit="submitName(); return false;">
      <input class="label" type="text" id="userName" placeholder="Your name here" autocomplete="off" autofocus>
    </form>
    (Hit 'Enter' to submit)
    <br>
    
    <a href="./welcome.html"><button>Start</button></a>
  -->
    <button id='back' onclick="redirect(true)">Start</button>
</body>

<script>
  document.getElementById("degree_toggle").addEventListener('change', function () {
    if (!document.getElementById("degree_toggle").checked) {
      document.getElementById("radian_toggle").checked = true
    }
  })

  document.getElementById("radian_toggle").addEventListener('change', function () {
    if (!document.getElementById("radian_toggle").checked) {
      document.getElementById("degree_toggle").checked = true
    }
  })

  document.getElementById("circle_toggle").addEventListener('change', function () {
    if (document.getElementById("circle_toggle").checked) {
      document.getElementById("coordinate_toggle").checked = true
    }
  })

  document.getElementById("coordinate_toggle").addEventListener('change', function () {
    if (!document.getElementById("coordinate_toggle").checked) {
      document.getElementById("circle_toggle").checked = false
    }
  })

  function updateSettings() {
    setCookie('full_circle_toggle', document.getElementById("full_circle_toggle").checked);
    setCookie('degree_toggle', document.getElementById("degree_toggle").checked);
    setCookie('radian_toggle', document.getElementById("radian_toggle").checked);
    setCookie('circle_toggle', document.getElementById("circle_toggle").checked);
    setCookie('coordinate_toggle', document.getElementById("coordinate_toggle").checked);
    setCookie('set', true);
    if (getCookie('redirect') == 'welcome'){document.getElementById('back').innerText = 'Back'}
  }

  function loadSettings() {
    document.getElementById("full_circle_toggle").checked = getCookie('full_circle_toggle')=='true';
    document.getElementById("degree_toggle").checked = getCookie('degree_toggle')=='true';
    document.getElementById("radian_toggle").checked = getCookie('radian_toggle')=='true';
    document.getElementById("circle_toggle").checked = getCookie('circle_toggle')=='true';
    document.getElementById("coordinate_toggle").checked = getCookie('coordinate_toggle')=='true';
  }

  document.getElementById("full_circle_toggle").addEventListener('change', function () {
    updateSettings();
  })

  document.getElementById("degree_toggle").addEventListener('change', function () {
    updateSettings();
  })

  document.getElementById("radian_toggle").addEventListener('change', function () {
    updateSettings();
  })

  document.getElementById("circle_toggle").addEventListener('change', function () {
    updateSettings();
  })

  document.getElementById("coordinate_toggle").addEventListener('change', function () {
    updateSettings();
  })

  function redirect(override) {
    if (override || !hold()) {
      console.log(getCookie('redirect'));
      switch (String(getCookie('redirect'))) {
        case "app1":
          window.location.href = './app1.html';
          break;
        case "app2":
          window.location.href = './app2.html';
          break;
        default:
          window.location.href = './welcome.html';
      }
    }
  }

  function hold() {
    let redir = getCookie('redirect');
    if (redir.charAt(0) != '#') { return false; }
    setCookie('redirect', getCookie('redirect').substring(1));
    return true;
  }
</script>


<script>
  Window.onload = redirect();
  Window.onload = scanCookies();
  Window.onload = loadSettings();
  Window.onload = updateSettings();
</script>